<%- include('partials/header') -%>
<div class="grid grid-cols-12">

  <!-- List of Reviews by each member of group. One for each member -->
  <div class="col-span-10">
      <div class="">

        <div>
          <form action="/groups/addMember/<%= group.id %>?_method=PUT" method="POST">
            <div class="form-control w-full max-w-xs">
                <label for="username" class="label">Member Username</label>
                <input type="text" placeholder="Add Member" class="input input-bordered input-primary w-full max-w-xs" id="username" name="username">
            </div>
            <button type="submit" class="btn btn-primary mt-2">Add Member</button>
          </form>

          <%if(group.createdBy == user.id){ %>
          <form
            action="/groups/deleteGroup/<%= group.id %>?_method=DELETE"
            method="POST"
            class="col-3"
          >
            <button class="btn btn-primary mt-2" type="submit">Delete Group</button>
          </form>
          <%}%>
        </div>
          <div>
            <% if (messages.groupCreateSuccess) { %>
                  <div class="alert alert-success"><%= messages.groupCreateSuccess %></div>
              <% } %>
            <% if (messages.success) { %>
                  <div class="alert alert-success"><%= messages.success %></div>
              <% } %>
              <% if (messages.error) { %>
                <div class="alert alert-danger"><%= messages.error %></div>
            <% } %>
              <p><strong>Group Name</strong>: <%= group.groupName %></p>
              <p><strong>Group Description</strong>: <%= group.groupDescription %></p>
             
              <ul class="grid grid-cols-3 place-items-center">
                <% for(var j=0; j<group.members.length; j++) {%>
                 <li class="mt-5">
                   <div class="card w-96 bg-base-300 shadow-xl">
                      <figure><img src="<%= group.members[j].posts[0].image%>" alt="review-card-image" /></figure>
                     <div class="card-body">
                       <a href="/post/<%= group.members[j].posts[0].id%>">
                         <h2 class="card-title"><%=group.members[j].posts[0].title%></h2>
                       </a>
                       <a href="/post/show/<%= group.members[j].id%>" class="link link-accent">
                        <h3 class="card-title text-base">By <%=group.members[j].userName%></h2>
                      </a>
                      <div class="badge badge-secondary"><%= group.members[j].posts[0].category %></div>
                       <p><%=group.members[j].posts[0].summary%></p>
                       <div class="card-actions justify-end">
                         <a href="/post/<%= group.members[j].posts[0].id%>" class="btn btn-primary">Read Review</a>
                       </div>
                     </div>
                   </div>
                 </li>
               <% } %>
             </ul>   
          </div>
         
        </div>  
    </div>

    <!-- Group Members Section on Right of Page -->
    <div class="overflow-x-auto col-span-2">
      <p class="text-center"><strong>Group Members</strong></p>
      <table class="table w-full">
        <!-- head -->
        <thead>
          <tr>
            <th></th>
            <th>Username</th>
            <th># of Reviews</th>
          </tr>
        </thead>
        <tbody>
          <!-- rows -->
          <% for(var i=0; i<group.members.length; i++) {%>
          <tr class="hover">
            <th><%= i %></th>
            <td><a href="/post/show/<%= group.members[i].id %>" class="link link-accent"><%= group.members[i].userName %></a></td>
            <td><%= i %></td>
          </tr>
          <% } %>
        </tbody>
      </table>
    </div>

  </div>
</div>
<%- include('partials/footer') -%>